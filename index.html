<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PFE Interactive Guide</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        @keyframes thumb-pop {
            0% { transform: scale(1); }
            50% { transform: scale(1.4); }
            100% { transform: scale(1.25); }
        }
        body {
            font-family: 'Inter', sans-serif;
            overflow: hidden; 
        }
        .container {
            height: 100vh;
            max-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .section {
            width: 100%;
            transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;
            position: absolute;
            opacity: 0;
            transform: scale(0.98);
            pointer-events: none;
            backface-visibility: hidden;
        }
        .section.active {
            opacity: 1;
            transform: scale(1);
            position: relative;
            pointer-events: auto;
            overflow-y: auto;
            overflow-x: hidden;
            padding: 1.5rem;
            max-height: 100%;
        }
        .section-container {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-grow: 1;
            width: 100%;
            overflow: hidden;
        }
        /* NEW UTILITY CLASS: Makes an element invisible but keeps its space in the layout */
        .invisible {
            visibility: hidden;
        }
        #quoteText {
            opacity: 0;
            transition: opacity 1s ease-in-out;
        }
        .message-box {
            position: fixed;
            bottom: -100px;
            left: 50%;
            transform: translateX(-50%);
            max-width: 500px;
            width: 90%;
            text-align: center;
            background-color: #ef4444;
            color: white;
            padding: 20px 40px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            z-index: 1000;
            transition: bottom 0.5s ease-in-out;
            border-radius: 1rem;
        }
        .message-box.show {
            bottom: 20px;
        }
        .is-checked {
            animation: thumb-pop 0.3s ease-out forwards;
            color: #10B981;
        }
        #casaImageContainer {
            position: relative;
            display: flex;
            justify-content: center;
        }
        #thumbsContainer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .thumb-label {
            position: absolute;
            transform: translate(-50%, -50%);
            cursor: pointer;
            padding: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e5e7eb;
            border-radius: 9999px;
            margin-bottom: 1rem;
            flex-shrink: 0;
        }
        #progressBar {
            padding-bottom: 1rem;
        }
        .progress-bar {
            height: 10px;
            background-color: #3b82f6;
            border-radius: 9999px;
            width: 0%;
            transition: width 0.5s ease-in-out;
        }
        .progress-steps {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-top: 0.5rem;
            font-size: 0.875rem;
            color: #6b7280;
        }
        .progress-step {
            transition: color 0.5s ease-in-out;
        }
        .progress-step.completed {
            color: #1f2937;
            font-weight: 500;
        }
    </style>
</head>
<body class="bg-slate-100 flex items-center justify-center p-6">
    <div class="container bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full">
        <div id="progressBar" class="hidden">
            <div class="progress-bar-container">
                <div id="progressBarFill" class="progress-bar"></div>
            </div>
            <div id="progressSteps" class="progress-steps">
                <span class="progress-step" id="step-1">Province</span>
                <span class="progress-step" id="step-2">Qualify</span>
                <span class="progress-step" id="step-3">Benefits</span>
                <span class="progress-step" id="step-4">Offers</span>
                <span class="progress-step" id="step-5">Summary</span>
            </div>
        </div>

        <div class="section-container">
            <div id="mainPage" class="section active text-center">
                <h1 class="text-5xl font-bold text-blue-700 mb-4">Purefiber East is here!</h1>
                <div class="h-16 flex items-center justify-center mb-2">
                    <p id="quoteText" class="text-xl italic text-slate-500"></p>
                </div>
                <h2 class="text-4xl font-bold text-slate-800 mb-6">Choose a Province</h2>
                <div class="flex justify-center space-x-4 mb-8">
                    <button data-province="ontario" class="province-btn bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-full shadow-lg transition-transform transform hover:scale-105">Ontario</button>
                    <button data-province="quebec" class="province-btn bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-full shadow-lg transition-transform transform hover:scale-105">Quebec</button>
                </div>
            </div>

            <div id="qualifyPage" class="section text-center">
                <h2 class="text-3xl font-semibold text-slate-700 mb-4 shrink-0">Qualify your customer</h2>
                <div id="quebecNonIlecContainer" class="flex justify-center items-center space-x-4 mb-6 shrink-0">
                    <label class="flex items-center text-lg text-slate-600 cursor-pointer">
                        <input type="checkbox" id="quebecNonIlecCheckbox" class="form-checkbox h-6 w-6 text-indigo-600 rounded">
                        <span class="ml-2">Non-Ilec Customer</span>
                    </label>
                </div>
                <div class="flex justify-center items-center space-x-4 mb-6 shrink-0">
                    <label class="flex items-center text-lg text-slate-600 cursor-pointer">
                        <input type="checkbox" id="casaAvailableCheckbox" class="form-checkbox h-6 w-6 text-indigo-600 rounded">
                        <span class="ml-2">Offer is available on casa</span>
                    </label>
                </div>
                <div id="casaImageContainer" class="mt-4 mb-6">
                    <img src="https://github.com/modexperimental/Pfe/blob/main/new%20prfe.jpg?raw=true" alt="Casa offer details" class="rounded-lg shadow-md w-[415px] h-[500px]">
                    <div id="thumbsContainer">
                        <label class="thumb-label" id="thumbsUpContainer">
                            <input type="checkbox" id="thumbsUpCheckbox" class="opacity-0 absolute">
                            <span id="thumbIcon1"></span>
                        </label>
                        <label class="thumb-label" id="thumbsUpContainer2">
                            <input type="checkbox" id="thumbsUpCheckbox2" class="opacity-0 absolute">
                            <span id="thumbIcon2"></span>
                        </label>
                    </div>
                </div>
                <div class="flex space-x-4 justify-center mt-6 shrink-0">
                    <button class="back-btn bg-slate-400 hover:bg-slate-500 text-white font-medium py-3 px-8 rounded-full">Back</button>
                    <button id="qualifyNextBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-full">Next</button>
                </div>
            </div>

            <div id="benefitsPage" class="section text-center">
                <h2 class="text-3xl font-semibold text-slate-700 mb-4">Position Yourself with The Benefits of Purefiber and Wifi+</h2>
                <div class="flex items-center justify-center mb-4">
                    <button id="securityPrevBtn" class="text-3xl p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors mr-4">&lt;</button>
                    <p id="securityQuoteText" class="text-xl italic text-slate-600 min-h-[100px] flex items-center justify-center max-w-lg"></p>
                    <button id="securityNextBtn" class="text-3xl p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors ml-4">&gt;</button>
                </div>
                <div class="flex space-x-4 justify-center mt-6">
                    <button class="back-btn bg-slate-400 hover:bg-slate-500 text-white font-medium py-3 px-8 rounded-full">Back</button>
                    <button id="benefitsNextBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-full">Next</button>
                </div>
            </div>

            <div id="offersPage" class="section text-center">
                <h2 id="offersTitle" class="text-3xl font-semibold text-slate-700 mb-4"></h2>
                <div class="flex flex-col sm:flex-row justify-center items-center space-y-4 sm:space-y-0 sm:space-x-8 mb-6">
                    <label class="flex items-center text-lg text-slate-600 cursor-pointer">
                        <input type="checkbox" id="offerPureFiber" class="offer-checkbox form-checkbox h-6 w-6 text-indigo-600 rounded">
                        <span class="ml-2">PureFiber</span>
                    </label>
                    <label class="flex items-center text-lg text-slate-600 cursor-pointer">
                        <input type="checkbox" id="offerWifiPlus" class="offer-checkbox form-checkbox h-6 w-6 text-indigo-600 rounded">
                        <span class="ml-2">Wifi+</span>
                    </label>
                </div>
                <div id="offerCarousel" class="mt-4 w-full flex-col items-center hidden">
                    <div class="flex items-center justify-center w-full">
                        <button id="offerPrevImageBtn" class="text-3xl p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors mr-4">&lt;</button>
                        <img id="offerImage" src="" alt="Offer Image" class="rounded-lg shadow-md w-full h-auto max-w-md transition-opacity duration-300">
                        <button id="offerNextImageBtn" class="text-3xl p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors ml-4">&gt;</button>
                    </div>
                </div>
                <div class="flex space-x-4 justify-center mt-6">
                    <button class="back-btn bg-slate-400 hover:bg-slate-500 text-white font-medium py-3 px-8 rounded-full">Back</button>
                    <button id="offersNextBtn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-full shadow-lg hidden">View Summary</button>
                </div>
            </div>

            <div id="summaryPage" class="section text-center">
                <h2 class="text-3xl font-semibold text-slate-700 mb-4">Summary</h2>
                <div id="summaryContent" class="text-left bg-slate-50 p-6 rounded-lg space-y-2 text-lg"></div>
                <div class="flex space-x-4 justify-center mt-6">
                    <button class="back-btn bg-slate-400 hover:bg-slate-500 text-white font-medium py-3 px-8 rounded-full">Back</button>
                    <button id="copySummaryBtn" class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-3 px-8 rounded-full">Copy to Clipboard</button>
                    <button id="restartBtn" class="bg-green-600 hover:bg-green-700 text-white font-medium py-3 px-8 rounded-full">Start Over</button>
                </div>
            </div>
        </div>
    </div>

    <div id="messageBox" class="message-box"></div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            
            const config = {
                quotes: {
                    main: ["1GB connection with unlimited data", "Wall to wall WiFi connection (When subscribed to WiFi Plus)", "High Speed connection", "Whole home wifi coverage (When subscribed to WiFi Plus)", "Troubleshooting is easier when you can see the health of the internet including WiFi", "Have all your services with one provider for a best end to end service", "Stay connected on all your devices, wherever you are in your home.", "Unlock the full potential of your smart home with one robust solution", "Get the speed you pay for, with no hidden fees or surprise throttling.", "A full view of all your services in one place gives us the insight to provide a better, more proactive experience."],
                    benefits: ["Wall to Wall connection (When subscribed to wifi plus)", "Smart security cameras rely on a stable connection to work properly.", "With our fiber internet, you won't have to worry about frustrating dropped connections.", "Your cameras can upload footage in real time, so you always have eyes on your home.", "Your whole family can be on their devices at once with no slowdowns.", "You can stream 4K movies and shows instantly on your TV.", "You'll never have to deal with buffering or long loading times again.", "Dead zones and disconnected devices are frustrating. Our solution ensures a strong, consistent coverage, so you can get a good connection from anywhere in your home, without the hassle.", "Answer your smart doorbell from anywhere instantly with a clear voice and video.", "A strong connection allows for seamless two-way communication.", "Our fiber provides the bandwidth you need for all your smart devices.", "Your outdoor camera is a key part of your home security. Fiber internet gives it the strong, stable connection it needs to upload a clear video of the yard or driveway right away. If something happens, you'll get your footage ready faster than before.", "This makes your entire smart home work smoothly and reliably.", "Your devices will stay connected no matter where you are in the house.", "Every corner of your home will have a fast, stable connection.", "A standard internet connection can get overwhelmed when multiple devicesâ€”like security system, and a streaming TVâ€”are all active. Fiber delivers a consistently strong signal to every single one of them, ensuring everything works perfectly at the same time.", "Get the full benefit of your internet speed, everywhere in your home.", "Our Wi-Fi provides a strong, consistent signal in every room.", "Smart devices like cameras rely on a stable connection to work properly. With our fiber internet, you won't have to worry about frustrating dropped connections that could leave your home vulnerable or your smart systems unresponsive.", "Get the full benefit of your internet speed, everywhere in your home.", "Smart security cameras need a strong, stable connection to protect your home."]
                },
                images: {
                    pureFiber: ['https://github.com/modexperimental/Pfe/blob/main/1.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/2.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/3.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/4.jpg?raw=true'],
                    wifiPlus: ['https://github.com/modexperimental/Pfe/blob/main/1-1.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/2-1.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/3-1.jpg?raw=true', 'https://github.com/modexperimental/Pfe/blob/main/4-1.jpg?raw=true']
                },
                thumbnails: [
                    { id: 'thumbsUpContainer', iconId: 'thumbIcon1', top: '84%', left: '55.3%', size: '1.35rem', icon: 'ðŸ‘' },
                    { id: 'thumbsUpContainer2', iconId: 'thumbIcon2', top: '88.7%', left: '55.3%', size: '1.35rem', icon: 'ðŸ‘' }
                ]
            };

            const state = { currentPage: 'mainPage', province: null, isNonIlec: false, isCasaAvailable: false, offers: { pureFiber: false, wifiPlus: false }, quoteInterval: null, currentBenefitQuoteIndex: 0, currentOfferImageIndex: 0 };

            const sections = document.querySelectorAll('.section');
            const messageBox = document.getElementById('messageBox');
            const quoteText = document.getElementById('quoteText');
            const securityQuoteText = document.getElementById('securityQuoteText');
            const casaImageContainer = document.getElementById('casaImageContainer');
            const quebecNonIlecContainer = document.getElementById('quebecNonIlecContainer');
            const progressBar = document.getElementById('progressBar');
            const progressBarFill = document.getElementById('progressBarFill');
            const progressSteps = document.getElementById('progressSteps').children;

            const initializeThumbnails = () => {
                config.thumbnails.forEach(thumb => {
                    const container = document.getElementById(thumb.id);
                    const iconSpan = document.getElementById(thumb.iconId);
                    if (container && iconSpan) {
                        container.style.top = thumb.top;
                        container.style.left = thumb.left;
                        container.style.fontSize = thumb.size;
                        iconSpan.textContent = thumb.icon;
                    }
                });
            };

            casaImageContainer.style.display = 'none';

            const navigateTo = (pageId) => {
                state.currentPage = pageId;
                sections.forEach(section => section.classList.toggle('active', section.id === pageId));
                updateProgressBar();
            };

            const showMessage = (message, duration = 2000) => {
                messageBox.textContent = message;
                messageBox.classList.add('show');
                setTimeout(() => messageBox.classList.remove('show'), duration);
            };

            const resetState = () => {
                state.province = null;
                state.isNonIlec = false;
                state.isCasaAvailable = false;
                state.offers.pureFiber = false;
                state.offers.wifiPlus = false;
                document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
                document.querySelectorAll('.is-checked').forEach(el => el.classList.remove('is-checked'));
                casaImageContainer.style.display = 'none';
                document.getElementById('offerCarousel').classList.add('hidden');
            };

            const updateProgressBar = () => {
                const pageOrder = ['mainPage', 'qualifyPage', 'benefitsPage', 'offersPage', 'summaryPage'];
                const currentIndex = pageOrder.indexOf(state.currentPage);
                if (currentIndex < 0 || state.currentPage === 'mainPage') {
                    progressBar.classList.add('hidden');
                    return;
                }
                progressBar.classList.remove('hidden');
                const percent = (currentIndex / (pageOrder.length - 1)) * 100;
                progressBarFill.style.width = `${percent}%`;
                for (let i = 0; i < progressSteps.length; i++) {
                    progressSteps[i].classList.toggle('completed', i <= currentIndex);
                }
            };
            
            const startMainQuotes = () => {
                let index = 0;
                const showNext = () => {
                    quoteText.style.opacity = 0;
                    setTimeout(() => {
                        quoteText.textContent = config.quotes.main[index];
                        quoteText.style.opacity = 1;
                        index = (index + 1) % config.quotes.main.length;
                    }, 1000);
                };
                showNext();
                state.quoteInterval = setInterval(showNext, 5000);
            };
            const stopMainQuotes = () => clearInterval(state.quoteInterval);

            const updateBenefitQuote = () => {
                securityQuoteText.textContent = config.quotes.benefits[state.currentBenefitQuoteIndex];
            };

            // MODIFIED: This function now uses 'invisible' class to prevent layout shifts
            const updateOfferCarousel = () => {
                const pureFiber = document.getElementById('offerPureFiber').checked;
                const wifiPlus = document.getElementById('offerWifiPlus').checked;
                const carousel = document.getElementById('offerCarousel');
                const nextBtn = document.getElementById('offersNextBtn');
                const offerNextImageBtn = document.getElementById('offerNextImageBtn');
                const offerPrevImageBtn = document.getElementById('offerPrevImageBtn');

                state.offers.pureFiber = pureFiber;
                state.offers.wifiPlus = wifiPlus;
                let images = [];
                if (wifiPlus) images = config.images.wifiPlus;
                else if (pureFiber) images = config.images.pureFiber;

                if (images.length > 0) {
                    carousel.classList.remove('hidden');
                    document.getElementById('offerImage').src = images[state.currentOfferImageIndex];
                    nextBtn.classList.toggle('hidden', state.currentOfferImageIndex !== images.length - 1);
                    
                    // Use 'invisible' to hide buttons but keep their space
                    offerNextImageBtn.classList.toggle('invisible', state.currentOfferImageIndex >= images.length - 1);
                    offerPrevImageBtn.classList.toggle('invisible', state.currentOfferImageIndex <= 0);
                } else {
                    carousel.classList.add('hidden');
                    nextBtn.classList.add('hidden');
                }
            };
            
            const generateSummary = () => {
                const content = `<p><strong>Province:</strong> ${state.province.charAt(0).toUpperCase() + state.province.slice(1)}</p>${state.province === 'quebec' ? `<p><strong>Customer Type:</strong> ${state.isNonIlec ? 'Non-Ilec' : 'Ilec'}</p>` : ''}<p><strong>Casa Offer Available:</strong> ${state.isCasaAvailable ? 'Yes' : 'No'}</p><p><strong>Selected Offers:</strong></p><ul class="list-disc list-inside ml-4">${state.offers.pureFiber ? '<li>PureFiber</li>' : ''}${state.offers.wifiPlus ? '<li>Wifi+</li>' : ''}${!state.offers.pureFiber && !state.offers.wifiPlus ? '<li>None</li>' : ''}</ul>`;
                document.getElementById('summaryContent').innerHTML = content;
            };

            document.querySelectorAll('.province-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    state.province = btn.dataset.province;
                    quebecNonIlecContainer.classList.toggle('hidden', state.province !== 'quebec');
                    stopMainQuotes();
                    navigateTo('qualifyPage');
                });
            });

            document.getElementById('casaAvailableCheckbox').addEventListener('change', (e) => {
                state.isCasaAvailable = e.target.checked;
                if (e.target.checked) {
                    casaImageContainer.style.display = 'flex';
                } else {
                    casaImageContainer.style.display = 'none';
                }
            });

            document.querySelectorAll('#thumbsContainer input').forEach(thumb => {
                thumb.addEventListener('change', (e) => {
                    e.target.nextElementSibling.classList.toggle('is-checked', e.target.checked);
                });
            });

            document.getElementById('qualifyNextBtn').addEventListener('click', () => {
                if (state.province === 'quebec' && !document.getElementById('quebecNonIlecCheckbox').checked) return showMessage("For Quebec, please confirm 'Non-Ilec Customer' status.");
                if (!state.isCasaAvailable) return showMessage("Please confirm the offer is available on casa.");
                if (!document.getElementById('thumbsUpCheckbox').checked) return showMessage("Please click the primary thumbs-up icon to proceed.");
                state.isNonIlec = document.getElementById('quebecNonIlecCheckbox').checked;
                updateBenefitQuote();
                navigateTo('benefitsPage');
            });
            
            document.getElementById('securityPrevBtn').addEventListener('click', () => {
                state.currentBenefitQuoteIndex = (state.currentBenefitQuoteIndex - 1 + config.quotes.benefits.length) % config.quotes.benefits.length;
                updateBenefitQuote();
            });
            document.getElementById('securityNextBtn').addEventListener('click', () => {
                state.currentBenefitQuoteIndex = (state.currentBenefitQuoteIndex + 1) % config.quotes.benefits.length;
                updateBenefitQuote();
            });
            
            document.getElementById('benefitsNextBtn').addEventListener('click', () => {
                const title = document.getElementById('offersTitle');
                title.textContent = state.province === 'quebec' ? 'Live Transfer to "Offnet Sales" on WWE then submit lead on FLP' : 'The Customer is Interested in:';
                navigateTo('offersPage');
            });

            document.querySelectorAll('.offer-checkbox').forEach(cb => {
                cb.addEventListener('change', () => {
                    if (cb.id === 'offerWifiPlus' && cb.checked && !document.getElementById('offerPureFiber').checked) {
                        cb.checked = false;
                        return showMessage("Please select 'PureFiber' first.");
                    }
                    state.currentOfferImageIndex = 0;
                    updateOfferCarousel();
                });
            });
            
            document.getElementById('offerNextImageBtn').addEventListener('click', () => {
                state.currentOfferImageIndex++;
                updateOfferCarousel();
            });

            document.getElementById('offerPrevImageBtn').addEventListener('click', () => {
                state.currentOfferImageIndex--;
                updateOfferCarousel();
            });

            document.getElementById('offersNextBtn').addEventListener('click', () => {
                generateSummary();
                navigateTo('summaryPage');
            });

            document.getElementById('copySummaryBtn').addEventListener('click', () => {
                const textToCopy = document.getElementById('summaryContent').innerText;
                navigator.clipboard.writeText(textToCopy).then(() => showMessage("Summary copied to clipboard!", 1500));
            });
            
            document.getElementById('restartBtn').addEventListener('click', () => {
                resetState();
                startMainQuotes();
                navigateTo('mainPage');
            });

            document.querySelectorAll('.back-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    const pageMap = { qualifyPage: 'mainPage', benefitsPage: 'qualifyPage', offersPage: 'benefitsPage', summaryPage: 'offersPage' };
                    if (state.currentPage === 'qualifyPage') startMainQuotes();
                    navigateTo(pageMap[state.currentPage]);
                });
            });

            initializeThumbnails();
            startMainQuotes();
            updateProgressBar();
        });
    </script>
</body>

</html>

